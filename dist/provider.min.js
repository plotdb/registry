!function(){var n=require("node-fetch"),i=require("lderror"),t=n,e=function(n){return this._name=(n=null==n?{}:n).name||"unnamed"+e._idx++,this._ps=[].concat(n.chain||[]),this._fetch=n.fetch,this._url=n.url,this};e._hash={},e._idx=0,e.add=function(n){return this._hash[n._name]=n},e.get=function(n){return this._hash[n]},e.prototype=((n=Object.create(Object.prototype)).url=function(n){return this._url(n)},n.fetch=function(e){var r,u=this;return null==e&&(e={}),(r=function(t){var n;if(0<=(t=-1===(t=null==t?-1:t)&&!u._fetch?0:t)){if(!(n=u._ps[t]))return i.reject(404);n=n._fetch(e)}else n=u._fetch(e);return n.catch(function(n){return 404!==i.id(n)?Promise.reject(n):r(t+1)}).then(function(n){return n})})()},n.chain=function(n){this._ps.splice.apply(this._ps,[0,0].concat(n))},n),e.add(new e({name:"jsdelivr",url:function(n){var t=n.name,e=n.version,n=n.path;return"https://cdn.jsdelivr.net/npm/"+t+(e&&"@"+e||"")+(n&&"/"+n||"")},fetch:function(n){return t(this.url(n)).catch(function(){return i.reject(404)}).then(function(n){var t=n.headers.get("x-jsd-version");return t?n.text().then(function(n){return{version:t||version,content:n}}):i.reject(404)})}})),e.add(new e({name:"unpkg",url:function(n){var t=n.name,e=n.version,n=n.path;return"https://unpkg.com/"+t+(e&&"@"+e||"")+(n&&"/"+n||"")},fetch:function(e){return null==e&&(e={}),t(this.url(e)).catch(function(){return i.reject(404)}).then(function(n){var t=(/^https:\/\/unpkg.com\/([^@]+)@([^/]+)\//.exec(n.url)||[])[2];return n.text().then(function(n){return{version:t||e.version,content:n}})})}})),"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof window&&null!==window&&(window.registry=e)}.call(this);
